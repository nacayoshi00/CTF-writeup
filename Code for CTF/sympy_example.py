from pwn import *
from sympy import *

context(arch = 'i386', os = 'linux')
primelist=[]
count=0

while 1:

    r = remote('nttvuln2014.picoctf.com', 51818)
    # EXPLOIT CODE GOES HERE

    a = r.recvline()
    pubkey1 = int(r.recvline(),16)

    r.close()

    r = remote('nttvuln2014.picoctf.com', 51818)
    # EXPLOIT CODE GOES HERE

    a = r.recvline()
    pubkey2 = int(r.recvline(),16)

    r.close()

    prime = gcd(pubkey1,pubkey2)
    print prime
    if (prime != 1):
#        if (str(prime) in primelist == False):
            primelist.append(str(prime))
            print "+"+str(prime)
            count += 1
            if count== 60:
                break
primelist.sort()
for i in primelist:
    print i


# factorization
sympy.factorint(2016)

{345709341936068338730678003778405323582109317075021198605451259081268526297654818935837545259489748700537817158904946124698593212156185601832821337576558516676594811692389205842412600462658083813048872307642872332289082295535733483056820073388473845450507806559178316793666044371642249466611007764799781626418800031166072773475575269610775901034485376573476373962417949231752698909821646794161147858557311852386822684705642251949742285300552861190676326816587042282505137369676427345123087656274137257931639760324708350318503061363031086796994100943084772281097123781070811610760735943618425858558459014484742232018933L: 1, 
345709341936068338730678003778405323582109317075021198605451259081268526297654818935837545259489748700537817158904946124698593212156185601832821337576558516676594811692389205842412600462658083813048872307642872332289082295535733483056820073388473845450507806559178316793666044371642249466611007764799781626418800031166072773475575269610775901034485376573476373962417949231752698909821646794161147858557311852386822684705642251949742285300552861190676326816587042282505137369676427345123087656274137257931639760324708350318503061363031086796994100943084772281097123781070811610760735943618425858558459014484742232019973L: 1